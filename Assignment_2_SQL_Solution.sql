WITH CTE AS (SELECT 20230101 AS TRANSACTIONDATE, 100 AS ACCOUNTNUMBER,'Credit' AS TRANSACTIONTYPE, 1000 AS AMOUNT UNION ALL
SELECT 20230102 AS TRANSACTIONDATE, 100 AS ACCOUNTNUMBER,'Credit ' AS TRANSACTIONTYPE, 1500 AS AMOUNT UNION ALL
SELECT 20230103 AS TRANSACTIONDATE, 100 AS ACCOUNTNUMBER,'Debit ' AS TRANSACTIONTYPE, 1000 AS AMOUNT UNION ALL
SELECT 20230102 AS TRANSACTIONDATE, 200 AS ACCOUNTNUMBER,'Credit' AS TRANSACTIONTYPE, 3500 AS AMOUNT UNION ALL
SELECT 20230103 AS TRANSACTIONDATE, 200 AS ACCOUNTNUMBER,'Debit ' AS TRANSACTIONTYPE, 2000 AS AMOUNT UNION ALL
SELECT 20230104 AS TRANSACTIONDATE, 200 AS ACCOUNTNUMBER,'Credit' AS TRANSACTIONTYPE, 3500 AS AMOUNT UNION ALL
SELECT 20230113 AS TRANSACTIONDATE, 300 AS ACCOUNTNUMBER,'Credit ' AS TRANSACTIONTYPE, 4000 AS AMOUNT UNION ALL
SELECT 20230114 AS TRANSACTIONDATE, 300 AS ACCOUNTNUMBER,'Debit' AS TRANSACTIONTYPE, 4500 AS AMOUNT UNION ALL
SELECT 20230115 AS TRANSACTIONDATE, 300 AS ACCOUNTNUMBER,'Credit' AS TRANSACTIONTYPE, 1500 AS AMOUNT)


SELECT TRANSACTIONDATE,ACCOUNTNUMBER,TRANSACTIONTYPE,AMOUNT,
SUM(AMT) OVER (PARTITION BY ACCOUNTNUMBER ORDER BY TRANSACTIONDATE) CURRENT_BALANCE FROM (
SELECT TRANSACTIONDATE,ACCOUNTNUMBER,TRANSACTIONTYPE,AMOUNT, 
CASE WHEN TRANSACTIONTYPE = 'Credit' THEN AMOUNT ELSE -(AMOUNT) END AMT FROM CTE) RES